<!DOCTYPE HTML>
<!--
	Editorial by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Intercomparison - Visualized by Group 10		</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<!--OpenLayers-->
		<link rel="stylesheet" href="v6.4.3/css/ol.css">
		<script src="v6.4.3/build/ol.js"></script>
		<!--Layer switcher-->
		<link rel="stylesheet" href="assets/css/ol-layerswitcher.css">
		<script src="assets/js/ol-layerswitcher.js"></script>
		<!--Bootstrap-->
		<link rel="stylesheet" href="v6.4.3/apidoc/styles/bootstrap.min.css">
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<div id="main">
						<div class="inner">

							<!-- Header -->
								<header id="header">
									<a href="index.html" class="logo"><strong>Visualized</strong> by Group 10</a>
									<ul class="icons">
										<!--<li><a href="#" class="icon brands fa-twitter"><span class="label">Twitter</span></a></li>
										<li><a href="#" class="icon brands fa-facebook-f"><span class="label">Facebook</span></a></li>
										<li><a href="#" class="icon brands fa-snapchat-ghost"><span class="label">Snapchat</span></a></li>
										<li><a href="#" class="icon brands fa-instagram"><span class="label">Instagram</span></a></li>
										<li><a href="#" class="icon brands fa-medium-m"><span class="label">Medium</span></a></li>-->
									</ul>
								</header>

							<!-- Content -->
								<section>
									<header class="main">
										<h1>Intercomparison</h1>
									</header>
									<p>A comparison of the two datasets to assess to which extent two of them share the same information. It provides preliminary information about accuracy because the better the two maps represent the reality the more similar they will be. To make intercomparison, the maps must have the same extent, resolution, pixel classes or variable, and CRS.</p>

									<div id="map1">
										<div id="popup1"></div>
									</div>

									<hr class="major" />
									<!-- codes for operation for each tile -->
									<p>Both maps are based on local data, big satellite data and both mainly sense the presence of building to estimate the population but they use different logics, methods and algorithms to do it. We therefore have two independent and not comparable datasets of the same thing. In each map the choice of the values ​​to put on the inland water bodies and the value representing the no-data is different: this is the main issue we have to fix. In fact, in the GHS map null values (= -200) are present on seas and oceans while in the WorldPop map null values (= -32768) are present also over inland water bodies, where GHS-POP has values = 0 which means not populated. It is therefore necessary to pre-process the data and then make the intercomparison. </p>

									<p>1)PREPROCESSING</p>    

									<p>With the preprocessing step two comparable maps will be obtained: through this step the maps are clipped, aligned and the same values in both are set in order to harmonize the datasets regarding what their values represent.</p>

									<p>2)PROCESSING</p>

									<p>With the processing step, once the difference between the two maps has been done, the correlation matrix and statistical information are computed. Lastly the correlation matrix of each single tile is calculated. </p>

									<hr class="major" />
									<h2>How to intercompare automatically?</h2>
									<p>Run python scripts in QGIS!</p>
									<div class="tab">
										<button class="tablinks" onclick="openCode(event, 'step1', 'assets/scripts/intercomp_1.py')">Step 1 Preprocessing</button>
										<button class="tablinks" onclick="openCode(event, 'step2', 'assets/scripts/intercomp_2.py')">Step 2 Processing</button>
									  </div>
									  
									  <!-- Tab content -->
									  <div id="step1" class="tabcontent">
										  <pre><code id='step1_code'></code></pre>
									  </div>
									  
									  <div id="step2" class="tabcontent">
										<pre><code id='step2_code'></code></pre>
									  </div>
									<div>

									<hr class="major" />
									<!-- Statistics -->
									<h2 id="elements">Statistics</h2>
										<!-- Table -->
										<div class="table-wrapper">
											<table id='stats'>
												<thead>
													<tr>
														<th>Index</th>
														<th>Value</th>
													</tr>
												</thead>
												<tbody>
												</tbody>
											</table>
										</div>


									<hr class="major" />
									<!-- correlation matrix -->
									<h2>Correlation Matrix</h2>
									<div class="box">
										<IFRAME NAME="content_frame" width=100% SRC="assets/stats/covariance_matrix.html" ></IFRAME>
										<p> If you want to know the correlation index of the single tile, click on it in the map!</p>
									</div>
									<!-- Conclusion -->
									<h2 id="elements">Conclusion</h2>
									<p> The correlation matrix measures the similarities between the two maps, the greater the differences, the worse the correlation index gets. The matrix shown above is a square, positive and symmetrical matrix. Since we are comparing two maps, the matrix will have two rows and two columns.The first row and column are associated with GHS map while the second ones are associated with Worldpop map, that’s the reason why we find 1 on the diagonal: both maps are 100% correlated with themselves. Observing the matrix obtained it is possible to state that the linear correlation between the maps is strong, its index is in fact 0.944534. The results obtained are consisten, the difference of the Worldpop map compared to the GHS one is minimal.The fact that the tiles of group_10 covered some uninhabited areas helped to have a higher correlation index. Analyzing the correlation index of each single tile, we observe that this tends to increase in the sea and in the northern islands: in these places there is no population (NaN values) and therefore the correlation index is 1. On the contrary in the mainland, as the population increased, the index worsened.</p>
								</section>

						</div>
					</div>

				<!-- Sidebar -->
				<div id="sidebar">
					<div class="inner">

						<!-- Search -->
							<section id="search" class="alt">
								<form method="post" action="#">
									<input type="text" name="query" id="query" placeholder="Search" />
								</form>
							</section>

						<!-- Menu -->
							<nav id="menu">
								<header class="major">
									<h2>Menu</h2>
								</header>
								<ul>
									<li><a href="index.html">Homepage</a></li>
									<li><a href="intercomp.html">Intercomparison</a></li>
									<li><a href="valid.html">Validation</a></li>
								</ul>
							</nav>

						<!-- Section -->
							<section>
								<header class="major">
									<h2>About Us</h2>
								</header>
								<p>Here are the members of group 10 ^ _ ^</p>
								<ul class="contact">
									<li class="icon solid fa-female">RIGAMONTI DOROTEA MARIA<br><a href="#">doroteamaria.rigamonti@mail.polimi.it</a></li>
									<li class="icon solid fa-female">PILEGGI CHIARA<br><a href="#">chiara.pileggi@mail.polimi.it</a></li>
									<li class="icon solid fa-female">XU QIONGJIE<br><a href="#">qiongjie.xu@mail.polimi.it</a></li>
								</ul>
							</section>

						<!-- Footer -->
							<footer id="footer">
								<p class="copyright">&copy; GIS Lab Group 10. All rights reserved. Design: <a href="https://html5up.net">HTML5 UP</a>.</p>
							</footer>

					</div>
				</div>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
			<script src="v6.4.3/apidoc/scripts/bootstrap.bundle.min.js"></script>
			<!--Script of Map-->
			<script src="assets/js/map.js"></script>
			<script>
				console.log("Begin to load stats for intercomp_diff")
				$.ajax({
					type: "GET",
					url: "assets/stats/intercomp_diff_stats.txt",
					dataType: "text",
					success: function(data) {
						console.log("[SUCCESS] Request stats for intercomp_diff")
						var table = $('#stats')
						var tmp = data.split('\n');
						var heads = tmp[0].split('|');
						data = tmp[1].split('|')
						$(data).each(function(i, val){
							//console.log(heads[i], val);
							var row = '<tr><td>' + heads[i] + '</td><td>' + val + '</td></tr>';
							table.append(row);
						});
					}
				})

				$.ajax({
					type: "GET",
					url: "assets/scripts/intercomp_1.py",
					dataType: "text",
					success: function(data) {
						document.getElementById('step1_code').innerText = data
					}
				})
				$.ajax({
					type: "GET",
					url: "assets/scripts/intercomp_2.py",
					dataType: "text",
					success: function(data) {
						document.getElementById('step2_code').innerText = data
					}
				})

				function openCode(evt, step) {
					var i, tabcontent, tablinks;

					tabcontent = document.getElementsByClassName("tabcontent");
					for (i = 0; i < tabcontent.length; i++) {
						tabcontent[i].style.display = "none";
					}

					// Get all elements with class="tablinks" and remove the class "active"
					tablinks = document.getElementsByClassName("tablinks");
					for (i = 0; i < tablinks.length; i++) {
						tablinks[i].className = tablinks[i].className.replace(" active", "");
					}

					// Show the current tab, and add an "active" class to the button that opened the tab
					document.getElementById(step).style.display = "grid";
					evt.currentTarget.className += " active";
				}
			</script>

	</body>
</html>
